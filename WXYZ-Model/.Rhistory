fitdistcens(fdcdata, distr="weibull")
simtime <- rweibull(100,shape=2.11, scale = 2.42)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.11, scale = 2.42)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.11, scale = 4.42)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.11, scale = 0.42)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.11, scale = 3.42)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.25, scale = 3.50)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
WtoP <- function(t, clength, wshape, wscale){
tProb <- 1-exp(wscale*(t*clength - clength)**wshape - scale*t*clength**wshape)
return(tProb)}
WtoP(4,1, 1.25, 3.5)
WtoP <- function(t, clength, wshape, wscale){
tProb <- 1-exp(wscale*(t*clength - clength)**wshape - wscale*t*clength**wshape)
return(tProb)}
WtoP(4,1, 1.25, 3.5)
WtoP(2,1, 1.25, 3.5)
WtoP(7,1, 1.25, 3.5)
WtoP <- function(t, clength, wshape, wscale){
tProb <- 1-exp(wscale*(t*clength - clength)**wshape - (wscale*t*clength)**wshape)
return(tProb)}
WtoP(4,1, 1.25, 3.5)
wscale
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)**gmma)) - lmbda*(t**gmma))
return(tProb)}
WtoP(4,1, 1.25, 3.5)
WtoP(4,1, 1.25, 3.5)
WtoP(4,1, 1.25, 1.5)
WtoP(1,1, 1.25, 1.5)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wscale
lmbda <- wshape
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)**gmma)) - lmbda*(t**gmma))
return(tProb)}
WtoP(1,1, 1.25, 1.5)
WtoP(2,1, 1.25, 1.5)
WtoP(3,1, 1.25, 1.5)
simtime <- rweibull(100,shape=1.25, scale = 3.50)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.25, scale = 3.50)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.25, scale = 3.50)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
View(paramtest)
fitdistcens(fdcdata, distr="weibull")
WtoP(1,1, 1.25, 1.5)
0*2.42
0**2.42
exp(-2.42*(1**2.11))
-2.42*(1**2.11)
-2.42*(1**2.11)
exp(-2.42)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)**gmma)) - lmbda*(t**gmma))
return(tProb)}
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)^gmma)) - lmbda*(t^gmma))
return(tProb)}
WtoP(1,1, 1.25, 1.5)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- ln(wshape)
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)^gmma)) - lmbda*(t^gmma))
return(tProb)}
WtoP(1,1, 1.25, 1.5)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- log(wshape)
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)^gmma)) - lmbda*(t^gmma))
return(tProb)}
WtoP(1,1, 1.25, 1.5)
WtoP(2,1, 1.25, 1.5)
WtoP(3,1, 1.25, 1.5)
WtoP(4,1, 1.25, 1.5)
WtoP(10,1, 1.25, 1.5)
WtoP(1,1, 1.25, 1.5)
WtoP(1,1, 2.42, 2.11)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- log(wscale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*((t-u)^gmma)) - lmbda*(t^gmma))
return(tProb)}
WtoP(1,1, 2.42, 2.11)
WtoP(2,1, 2.42, 2.11)
log(2.42)
log(1.25)
fitdistcens(fdcdata, distr="weibull")
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*((t+clength)^gmma))
return(tProb)}
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(2,1, 2.42, 2.11)
WtoP(1,1, 2.42, 2.11)
WtoP(2,1, 2.42, 2.11)
WtoP(3,1, 2.42, 2.11)
log(3.2)
ftcens <- fitdistcens(fdcdata, distr="weibull")
summary(ftcens)
exp(log(5))
test
summary(test)
ftcens <- fitdistcens(fdcdata, distr="weibull")
ftcens
summary*ftcens
summary(ftcens)
plot(ftcens)
plot(test)
simtime <- rweibull(100,shape=2.113, scale = 2.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
plot(test)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale^(1/log(1/wshape))
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(1,1,2.113, 2.424)
WtoP(2,1,2.113, 2.424)
WtoP(3,1,2.113, 2.424)
WtoP(4,1,2.113, 2.424)
(lmbda*(t^gmma) - lmbda*(t+clength)^gmma)
plot(paramtest, title="Observed Data")
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
simtime <- rweibull(100,shape=1.5, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(100,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=2.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=1.6, scale = 2.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=1.6, scale = 1.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=10.6, scale = 1.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=0.6, scale = 1.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(1000,shape=1.6, scale = 2.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 2.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=1.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale^(1/log(1/shape))
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,1.6,2.424)
WtoP <- function(cycle, clength, wshape, wscale){
gmma <- wshape
lmbda <- wscale^(1/log(1/wshape))
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,1.6,2.424)
WtoP(1,1,1.6,2.424)
WtoP(3,1,1.6,2.424)
WtoP(4,1,1.6,2.424)
WtoP(5,1,1.6,2.424)
WtoP(6,1,1.6,2.424)
WtoP(7,1,1.6,2.424)
WtoP(8,1,1.6,2.424)
simtime <- rweibull(250,shape=0.6, scale = 3.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=0.6, scale = 1.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=0.3, scale = 1.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=0.6, scale = 2.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
simtime <- rweibull(250,shape=0.6, scale = 0.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
WtoP(0,1,0.6,0.424)
WtoP(1,1,0.6,0.424)
wshape = 1.6
wscale = 2.424
intercept = log(wscale)
log_scale = log(1/wshape)
intercept
log_scale
WtoP <- function(cycle, clength, wshape, wscale){
intercept = log(wscale)
log_scale = log(1/wshape)
lambda <- 1/(exp(intercept))^ (1/exp(log_scale))
gamma <- 1/exp(log_scale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,1.6,2.424)
WtoP <- function(cycle, clength, wshape, wscale){
intercept = log(wscale)
log_scale = log(1/wshape)
lmbda <- 1/(exp(intercept))^ (1/exp(log_scale))
gmma <- 1/exp(log_scale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,1.6,2.424)
WtoP(1,1,1.6,2.424)
WtoP(2,1,1.6,2.424)
WtoP(3,1,1.6,2.424)
WtoP(4,1,1.6,2.424)
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
leftcol <- survdata$Time
rightcol <- rep(0, nrow(survdata))
for (i in 1:length(survdata$Event)){
if(survdata$Event[i] == 0){
rightcol[i] <- NA } else {
rightcol[i] <- survdata$Time[i]
}
}
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
leftcol <- survdata$Time
rightcol <- rep(0, nrow(survdata))
for (i in 1:length(survdata$Event)){
if(survdata$Event[i] == 0){
rightcol[i] <- NA } else {
rightcol[i] <- survdata$Time[i]
}
}
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
test <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(test)
leftcol <- survdata$Time
rightcol <- rep(0, nrow(survdata))
for (i in 1:length(survdata$Event)){
if(survdata$Event[i] == 0){
rightcol[i] <- NA } else {
rightcol[i] <- survdata$Time[i]
}
}
fdcdata <- data.frame(left = leftcol,
right = rightcol)
ftcens <- fitdistcens(fdcdata, distr="weibull")
simtime <- rweibull(250,shape=0.6, scale = 0.424)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
summary(paramtest)
summary(ftcens)
wshape = 0.874
wscale = 1.657
wshape = 0.874
wscale = 1.657
### t = time in model, so i in 1:ncycle
### cdays = cycle length, in days
### p = weibull shape parameter from regression.
### const = constant in regression
WtoP <- function(cycle, clength, wshape, wscale){
intercept = log(wscale)
log_scale = log(1/wshape)
lmbda <- 1/(exp(intercept))^ (1/exp(log_scale))
gmma <- 1/exp(log_scale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,wshape, wscale)
WtoP(1,1,wshape, wscale)
WtoP(2,1,wshape, wscale)
WtoP(3,1,wshape, wscale)
WtoP(4,1,wshape, wscale)
intercept = log(wscale)
log_scale = log(1/wshape)
lmbda <- 1/(exp(intercept))^ (1/exp(log_scale))
gmma <- 1/exp(log_scale)
lmdba
lmbda
gmma
intercept
wshape = -1/0.5436452
wscale = exp(3.494443)
### t = time in model, so i in 1:ncycle
### cdays = cycle length, in days
### p = weibull shape parameter from regression.
### const = constant in regression
WtoP <- function(cycle, clength, wshape, wscale){
intercept = log(wscale)
log_scale = log(1/wshape)
lmbda <- 1/(exp(intercept))^ (1/exp(log_scale))
gmma <- 1/exp(log_scale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,wshape, wscale)
WtoP(1,1,wshape, wscale)
WtoP(2,1,wshape, wscale)
WtoP(3,1,wshape, wscale)
WtoP(4,1,wshape, wscale)
intercept = log(wscale)
log_scale = log(1/wshape)
wshape = -1/exp(0.5436452)
wscale = exp(3.494443)
log_scale = log(1/wshape)
exp(0.5436452)
1/exp(0.5436452)
log_scale = log(1/wshape)
wshape = 1/exp(0.5436452)
log_scale = log(1/wshape)
log_scale
exp(-0.5436452)
wshape = 1/exp(-0.5436452)
wscale = exp(3.494443)
log_scale = log(1/wshape)
log_scale
WtoP <- function(cycle, clength, wshape, wscale){
intercept = log(wscale)
log_scale = log(1/wshape)
lmbda <- 1/(exp(intercept))^ (1/exp(log_scale))
gmma <- 1/exp(log_scale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,wshape, wscale)
WtoP(1,1,wshape, wscale)
WtoP(2,1,wshape, wscale)
WtoP(3,1,wshape, wscale)
WtoP(4,1,wshape, wscale)
intercept
wshape
wscale
ftcens <- fitdistcens(fdcdata, distr="weibull")
ftcens
ftcens$shape
ftcens$Parameters
ftcens$estimate
ftcens$estimate[1]
ftcens$estimate$shape
ftcens$estimate.shape
ftcens$estimate[2]
survdata <- read_excel("~/Desktop/My Work/Healthy Uncertainty/Code/Time-Varying WXYZ/RandomSurvData.xlsx")
obs_surv <- survfit(Surv(Time, Event) ~1, data = survdata)
plot(obs_surv)
leftcol <- survdata$Time
rightcol <- rep(0, nrow(survdata))
for (i in 1:length(survdata$Event)){
if(survdata$Event[i] == 0){
rightcol[i] <- NA } else {
rightcol[i] <- survdata$Time[i]
}
}
fdcdata <- data.frame(left = leftcol,
right = rightcol)
ftcens <- fitdistcens(fdcdata, distr="weibull")
as.numeric(ftcens$estimate[1])
wshape = as.numeric(ftcens$estimate[1])
wscale = as.numeric(ftcens$estimate[2])
simtime <- rweibull(250,shape=wshape, scale = wscale)
paramtest <- survfit(Surv(simtime) ~1)
plot(paramtest)
plotsim <- plot(paramtest)
plotsim <- plot(paramtest, main="Simulated")
plot(obs_surv, main="Observed")
plot(paramtest, main="Simulated")
plot(paramtest, main="Simulated", xlim=c(0,max(leftcol)))
max(leftcol)
c(0,max(leftcol)
)
plot(paramtest, main="Simulated", xlim=c(0,max(leftcol)))
plot(obs_surv, main="Observed")
plot(paramtest, main="Simulated", xlim=c(0,max(leftcol)))
WtoP <- function(cycle, clength, wshape, wscale){
intercept = log(wscale)
log_scale = log(1/wshape)
lmbda <- 1/(exp(intercept))^ (1/exp(log_scale))
gmma <- 1/exp(log_scale)
t <- cycle*clength
u <- clength
tProb <- 1 - exp((lmbda*(t^gmma) - lmbda*(t+clength)^gmma))
return(tProb)}
WtoP(0,1,wshape, wscale)
WtoP(1,1,wshape, wscale)
WtoP(2,1,wshape, wscale)
WtoP(3,1,wshape, wscale)
WtoP(4,1,wshape, wscale)
install.packages("flexsurv")
library("flexsurv")
obs_surv <- flexsurvreg(Surv(Time, Event) ~1, data = survdata)
obs_surv <- flexsurvreg(Surv(Time, Event) ~1, data = survdata, dist= "weibull")
summary(obs_surv)
obs_surv
plot(obs_surv, main="Observed")
plot(obs_surv, main="Observed")
obs_surv <- flexsurvreg(Surv(Time, Event) ~1, data = survdata, dist= "gamma")
surv_plot_obs <- plot(obs_surv, main="Observed")
